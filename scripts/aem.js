function sampleRUM(e,t){const n=()=>window.performance?window.performance.now():Date.now()-window.hlx.rum.firstReadTime;try{if(window.hlx=window.hlx||{},!window.hlx.rum){sampleRUM.enhance=()=>{};const t=new URLSearchParams(window.location.search).get("rum"),r="on"===t&&1||"high"===window.SAMPLE_PAGEVIEWS_AT_RATE&&10||"low"===window.SAMPLE_PAGEVIEWS_AT_RATE&&1e3||100,o=Math.random().toString(36).slice(-4),a="off"!==t&&Math.random()*r<1;window.hlx.rum={weight:r,id:o,isSelected:a,firstReadTime:window.performance?window.performance.timeOrigin:Date.now(),sampleRUM,queue:[],collector:(...e)=>window.hlx.rum.queue.push(e)},a&&((e=>{const t={source:"undefined error"};try{t.target=e.toString(),t.source=e.stack.split("\n").filter(e=>e.match(/https?:\/\//)).shift().replace(/at ([^ ]+) \((.+)\)/,"$1@$2").replace(/ at /,"@").trim()}catch(e){}return t})(window.addEventListener("error",({error:e})=>{const t=(e=>{const t={source:"undefined error"};try{t.target=e.toString(),t.source=e.stack.split("\n").filter(e=>e.match(/https?:\/\//)).shift().replace(/at ([^ ]+) \((.+)\)/,"$1@$2").replace(/ at /,"@").trim()}catch(e){}return t})(e);sampleRUM("error",t)})),window.addEventListener("unhandledrejection",({reason:e})=>{let t={source:"Unhandled Rejection",target:e||"Unknown"};e instanceof Error&&(t=(e=>{const t={source:"undefined error"};try{t.target=e.toString(),t.source=e.stack.split("\n").filter(e=>e.match(/https?:\/\//)).shift().replace(/at ([^ ]+) \((.+)\)/,"$1@$2").replace(/ at /,"@").trim()}catch(e){}return t})(e)),sampleRUM("error",t)}),sampleRUM.baseURL=sampleRUM.baseURL||new URL(window.RUM_BASE||"/",new URL("https://rum.hlx.page")),sampleRUM.collectBaseURL=sampleRUM.collectBaseURL||sampleRUM.baseURL,sampleRUM.sendPing=(e,t,n={})=>{const i=JSON.stringify({weight:r,id:o,referer:window.location.href,checkpoint:e,t:time,...n}),a=window.RUM_PARAMS?`?${new URLSearchParams(window.RUM_PARAMS).toString()}`:"",{href:s,origin:c}=new URL(`.rum/${r}${a}`,sampleRUM.collectBaseURL),l=c===window.location.origin?new Blob([i],{type:"application/json"}):i;navigator.sendBeacon(s,l),console.debug(`ping:${e}`,n)},sampleRUM.sendPing("top",n()),sampleRUM.enhance=()=>{if(document.querySelector('script[src*="rum-enhancer"]'))return;const{enhancerVersion:e,enhancerHash:t}=sampleRUM.enhancerContext||{},n=document.createElement("script");t&&(n.integrity=t,n.setAttribute("crossorigin","anonymous")),n.src=new URL(`.rum/@adobe/helix-rum-enhancer@${e||"^2"}/src/index.js`,sampleRUM.baseURL).href,document.head.appendChild(n)},window.hlx.RUM_MANUAL_ENHANCE||sampleRUM.enhance())}window.hlx.rum&&window.hlx.rum.isSelected&&e&&window.hlx.rum.collector(e,t,n()),document.dispatchEvent(new CustomEvent("rum",{detail:{checkpoint:e,data:t}}))}catch(e){}}function setup(){window.hlx=window.hlx||{},window.hlx.RUM_MASK_URL="full",window.hlx.RUM_MANUAL_ENHANCE=!0,window.hlx.codeBasePath="",window.hlx.lighthouse=new URLSearchParams(window.location.search).get("lighthouse")==="on";const e=document.querySelector('script[src$="/scripts/scripts.js"]');if(e)try{[window.hlx.codeBasePath]=new URL(e.src).pathname.split("/scripts/scripts.js")}catch(e){console.log(e)}}function init(){setup(),sampleRUM.collectBaseURL=window.origin,sampleRUM()}function toClassName(e){return"string"==typeof e?e.toLowerCase().replace(/[^0-9a-z]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,""):""}function toCamelCase(e){return toClassName(e).replace(/-([a-z])/g,(e=>e[1].toUpperCase()))}function readBlockConfig(e){const t={};return e.querySelectorAll(":scope > div").forEach((e=>{if(e.children){const n=[...e.children];if(n[1]){const i=n[1],a=toClassName(n[0].textContent);let s="";if(i.querySelector("a")){const e=[...i.querySelectorAll("a")];s=1===e.length?e[0].href:e.map((e=>e.href))}else if(i.querySelector("img")){const e=[...i.querySelectorAll("img")];s=1===e.length?e[0].src:e.map((e=>e.src))}else if(i.querySelector("p")){const e=[...i.querySelectorAll("p")];s=1===e.length?e[0].textContent:e.map((e=>e.textContent))}else s=e.children[1].textContent;t[a]=s}}})),t}async function loadCSS(e){return new Promise(((t,n)=>{if(!document.querySelector(`head > link[href="${e}"]`)){const n=document.createElement("link");n.rel="stylesheet",n.href=e,n.onload=t,n.onerror=n,document.head.append(n)}else t()}))}async function loadScript(e,t){return new Promise(((n,i)=>{if(!document.querySelector(`head > script[src="${e}"]`)){const i=document.createElement("script");if(i.src=e,t)for(const e in t)i.setAttribute(e,t[e]);i.onload=n,i.onerror=i,document.head.append(i)}else n()}))}function getMetadata(e,t=document){const n=e&&e.includes(":")?"property":"name";return[...t.head.querySelectorAll(`meta[${n}="${e}"]`)].map((e=>e.content)).join(", ")||""}function createOptimizedPicture(e,t="",n=!1,i=[{media:"(min-width: 600px)",width:"2000"},{width:"750"}]){const a=new URL(e,window.location.href),s=document.createElement("picture"),{pathname:c}=a,l=c.substring(c.lastIndexOf(".")+1);return i.forEach((e=>{const t=document.createElement("source");e.media&&t.setAttribute("media",e.media),t.setAttribute("type","image/webp"),t.setAttribute("srcset",`${c}?width=${e.width}&format=webply&optimize=medium`),s.appendChild(t)})),i.forEach(((e,a)=>{if(a<i.length-1){const a=document.createElement("source");e.media&&a.setAttribute("media",e.media),a.setAttribute("srcset",`${c}?width=${e.width}&format=${l}&optimize=medium`),s.appendChild(a)}else{const a=document.createElement("img");a.setAttribute("loading",n?"eager":"lazy"),a.setAttribute("alt",t),s.appendChild(a),a.setAttribute("src",`${c}?width=${e.width}&format=${l}&optimize=medium`)}})),s}function decorateTemplateAndTheme(){const e=(e,t)=>{t.split(",").forEach((t=>{e.classList.add(toClassName(t.trim()))}))},t=getMetadata("template");t&&e(document.body,t);const n=getMetadata("theme");n&&e(document.body,n)}function wrapTextNodes(e){const t=["P","PRE","UL","OL","PICTURE","TABLE","H1","H2","H3","H4","H5","H6"],n=e=>{const t=document.createElement("p");t.append(...e.childNodes),e.append(t)};e.querySelectorAll(":scope > div > div").forEach((e=>{if(e.hasChildNodes()){const i=!!e.firstElementChild&&t.some((t=>e.firstElementChild.tagName===t));i||n(e),"PICTURE"===e.firstElementChild.tagName&&(e.children.length>1||!!e.textContent.trim())&&n(e)}}))}function decorateButtons(e){e.querySelectorAll("a").forEach((t=>{t.title=t.title||t.textContent,t.href!==t.textContent&&(!t.querySelector("img")&&(1===t.parentElement.childNodes.length&&("P"===t.parentElement.tagName||"DIV"===t.parentElement.tagName)&&(t.className="button",t.parentElement.classList.add("button-container")),1===t.parentElement.childNodes.length&&"STRONG"===t.parentElement.tagName&&1===t.parentElement.parentElement.childNodes.length&&"P"===t.parentElement.parentElement.tagName&&(t.className="button primary",t.parentElement.parentElement.classList.add("button-container")),1===t.parentElement.childNodes.length&&"EM"===t.parentElement.tagName&&1===t.parentElement.parentElement.childNodes.length&&"P"===t.parentElement.parentElement.tagName&&(t.className="button secondary",t.parentElement.parentElement.classList.add("button-container"))))}))}function decorateIcon(e,t="",n=""){const i=Array.from(e.classList).find((e=>e.startsWith("icon-"))).substring(5),a=document.createElement("img");a.dataset.iconName=i,a.src=`${window.hlx.codeBasePath}${t}/icons/${i}.svg`,a.alt=n,a.loading="lazy",a.width=16,a.height=16,e.append(a)}function decorateIcons(e,t=""){e.querySelectorAll("span.icon").forEach((e=>{decorateIcon(e,t)}))}function decorateSections(e){e.querySelectorAll(":scope > div").forEach((t=>{const n=[];let i=!1;[...t.children].forEach((e=>{"DIV"===e.tagName||!i?(n.push(document.createElement("div")),i="DIV"!==e.tagName,i&&n[n.length-1].classList.add("default-content-wrapper")):void 0,n[n.length-1].append(e)})),n.forEach((e=>t.append(e))),t.classList.add("section"),t.dataset.sectionStatus="initialized",t.style.display="none";const a=t.querySelector("div.section-metadata");if(a){const e=readBlockConfig(a);Object.keys(e).forEach((n=>{"style"===n?e.style.split(",").filter((e=>e)).map((e=>toClassName(e.trim()))).forEach((e=>t.classList.add(e))):t.dataset[toCamelCase(n)]=e[n]})),a.parentNode.remove()}}))}function buildBlock(e,t){const n=Array.isArray(t)?t:[[t]],i=document.createElement("div");i.classList.add(e),n.forEach((e=>{const t=document.createElement("div");e.forEach((e=>{const n=document.createElement("div"),i=e.elems?e.elems:[e];i.forEach((e=>{e&&("string"==typeof e?n.innerHTML+=e:n.appendChild(e))})),t.appendChild(n)})),i.appendChild(t)}));return i}async function loadBlock(e){const t=e.dataset.blockStatus;if("loading"!==t&&"loaded"!==t){e.dataset.blockStatus="loading";const t=e.dataset.blockName;try{const n=loadCSS(`${window.hlx.codeBasePath}/blocks/${t}/${t}.css`),i=new Promise((i=>{(async()=>{try{const n=await import(`${window.hlx.codeBasePath}/blocks/${t}/${t}.js`);n.default&&await n.default(e)}catch(e){console.log(`failed to load module for ${t}`,e)}i()})()}));await Promise.all([n,i])}catch(n){console.log(`failed to load block ${t}`,n)}e.dataset.blockStatus="loaded"}return e}function decorateBlock(e){const t=e.classList[0];t&&(e.classList.add("block"),e.dataset.blockName=t,e.dataset.blockStatus="initialized",wrapTextNodes(e),e.parentElement.classList.add(`${t}-wrapper`),(e.closest(".section")||{}).classList&&(e.closest(".section").classList.add(`${t}-container`)))}function decorateBlocks(e){e.querySelectorAll("div.section > div > div").forEach(decorateBlock)}async function loadHeader(e){const t=buildBlock("header","");return e.append(t),decorateBlock(t),loadBlock(t)}async function loadFooter(e){const t=buildBlock("footer","");return e.append(t),decorateBlock(t),loadBlock(t)}async function waitForFirstImage(e){const t=e.querySelector("img");await new Promise((e=>{t&&!t.complete?(t.setAttribute("loading","eager"),t.addEventListener("load",e),t.addEventListener("error",e)):e()}))}async function loadSection(e,t){const n=e.dataset.sectionStatus;if(!n||"initialized"===n){e.dataset.sectionStatus="loading";const n=[...e.querySelectorAll("div.block")];for(let e=0;e<n.length;e+=1)await loadBlock(n[e]);t&&await t(e),e.dataset.sectionStatus="loaded",e.style.display=null}}async function loadSections(e){const t=[...e.querySelectorAll("div.section")];for(let n=0;n<t.length;n+=1)await loadSection(t[n]),0===n&&sampleRUM.enhance&&sampleRUM.enhance()}init();export{buildBlock,createOptimizedPicture,decorateBlock,decorateBlocks,decorateButtons,decorateIcons,decorateSections,decorateTemplateAndTheme,getMetadata,loadBlock,loadCSS,loadFooter,loadHeader,loadScript,loadSection,loadSections,readBlockConfig,sampleRUM,setup,toCamelCase,toClassName,waitForFirstImage,wrapTextNodes};
